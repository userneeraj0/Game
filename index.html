<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>2048 Game</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      background: #faf8ef;
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 0;
      padding: 20px;
    }

    h1 {
      font-size: 36px;
      color: #776e65;
    }

    #game {
      width: 300px;
      height: 300px;
      margin: 20px auto;
      display: grid;
      grid-template: repeat(4, 1fr) / repeat(4, 1fr);
      gap: 5px;
      background: #bbada0;
      padding: 5px;
      border-radius: 6px;
    }

    .cell {
      background: #cdc1b4;
      font-size: 24px;
      color: #776e65;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      height: 70px;
      border-radius: 3px;
    }

    #score {
      font-size: 20px;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>2048</h1>
  <div id="score">Score: 0</div>
  <div id="game"></div>

  <script>
    const gameSize = 4;
    let score = 0;
    const gameBoard = [];

    function initBoard() {
      const gameDiv = document.getElementById("game");
      gameDiv.innerHTML = "";
      for (let i = 0; i < gameSize; i++) {
        gameBoard[i] = [];
        for (let j = 0; j < gameSize; j++) {
          gameBoard[i][j] = 0;
          const cell = document.createElement("div");
          cell.classList.add("cell");
          cell.id = "cell-" + i + "-" + j;
          gameDiv.appendChild(cell);
        }
      }
      addNewTile();
      addNewTile();
      updateBoard();
    }

    function addNewTile() {
      let empty = [];
      for (let i = 0; i < gameSize; i++) {
        for (let j = 0; j < gameSize; j++) {
          if (gameBoard[i][j] === 0) empty.push([i, j]);
        }
      }
      if (empty.length === 0) return;
      const [x, y] = empty[Math.floor(Math.random() * empty.length)];
      gameBoard[x][y] = Math.random() < 0.9 ? 2 : 4;
    }

    function updateBoard() {
      for (let i = 0; i < gameSize; i++) {
        for (let j = 0; j < gameSize; j++) {
          const cell = document.getElementById("cell-" + i + "-" + j);
          const value = gameBoard[i][j];
          cell.textContent = value === 0 ? "" : value;
          cell.style.background = getColor(value);
        }
      }
      document.getElementById("score").textContent = "Score: " + score;
    }

    function getColor(val) {
      const colors = {
        0: "#cdc1b4", 2: "#eee4da", 4: "#ede0c8", 8: "#f2b179",
        16: "#f59563", 32: "#f67c5f", 64: "#f65e3b", 128: "#edcf72",
        256: "#edcc61", 512: "#edc850", 1024: "#edc53f", 2048: "#edc22e"
      };
      return colors[val] || "#3c3a32";
    }

    function slide(row) {
      let arr = row.filter(v => v);
      for (let i = 0; i < arr.length - 1; i++) {
        if (arr[i] === arr[i + 1]) {
          arr[i] *= 2;
          score += arr[i];
          arr[i + 1] = 0;
        }
      }
      return arr.filter(v => v).concat(Array(gameSize - arr.filter(v => v).length).fill(0));
    }

    function rotate(board) {
      const newBoard = [];
      for (let i = 0; i < gameSize; i++) {
        newBoard[i] = [];
        for (let j = 0; j < gameSize; j++) {
          newBoard[i][j] = board[gameSize - j - 1][i];
        }
      }
      return newBoard;
    }

    function move(dir) {
      let rotated = gameBoard;
      for (let i = 0; i < dir; i++) rotated = rotate(rotated);
      let moved = false;
      for (let i = 0; i < gameSize; i++) {
        const newRow = slide(rotated[i]);
        if (JSON.stringify(newRow) !== JSON.stringify(rotated[i])) moved = true;
        rotated[i] = newRow;
      }
      for (let i = 0; i < (4 - dir) % 4; i++) rotated = rotate(rotated);
      if (moved) {
        gameBoard.splice(0, gameBoard.length, ...rotated);
        addNewTile();
        updateBoard();
        checkGameOver();
      }
    }

    function checkGameOver() {
      for (let i = 0; i < gameSize; i++) {
        for (let j = 0; j < gameSize; j++) {
          if (gameBoard[i][j] === 0) return;
          if (j < gameSize - 1 && gameBoard[i][j] === gameBoard[i][j + 1]) return;
          if (i < gameSize - 1 && gameBoard[i][j] === gameBoard[i + 1][j]) return;
        }
      }
      alert("Game Over! Your score: " + score);
    }

    document.addEventListener("keydown", e => {
      switch (e.key) {
        case "ArrowLeft": move(0); break;
        case "ArrowUp": move(1); break;
        case "ArrowRight": move(2); break;
        case "ArrowDown": move(3); break;
      }
    });

    initBoard();
  </script>
</body>
</html>
